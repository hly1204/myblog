<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://hly1204.github.io/myblog/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://hly1204.github.io/myblog/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://hly1204.github.io/myblog/css/github.min.css' />
    <link rel="stylesheet" href='https://hly1204.github.io/myblog/css/github-style.css' />
    <link rel="stylesheet" href='https://hly1204.github.io/myblog/css/light.css' />
    <link rel="stylesheet" href='https://hly1204.github.io/myblog/css/dark.css' />
    <link rel="stylesheet" href='https://hly1204.github.io/myblog/css/syntax.css' />
    <title>Chirp Z 变换 - hly1204&#39;s blog</title>
    
    <link rel="icon" type="image/x-icon" href='https://hly1204.github.io/myblog/images/icon.png'>
    
    <meta name="theme-color" content="#1e2327">

    
    <meta name="description"
  content="学习一下逆 Chirp Z 变换" />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://hly1204.github.io/myblog/post/czt/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Chirp Z 变换 - hly1204&#39;s blog" />
<meta name="twitter:description"
  content="学习一下逆 Chirp Z 变换" />
<meta name="twitter:site" content="https://hly1204.github.io/myblog/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://hly1204.github.io/myblog/">


<meta property="og:type" content="article" />
<meta property="og:title" content="Chirp Z 变换 - hly1204&#39;s blog">
<meta property="og:description"
  content="学习一下逆 Chirp Z 变换" />
<meta property="og:url" content="https://hly1204.github.io/myblog/post/czt/" />
<meta property="og:site_name" content="Chirp Z 变换" />
<meta property="og:image"
  content="https://hly1204.github.io/myblog/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2024-06-12 22:39:13 &#43;0800 &#43;0800" />











</head>

<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="https://hly1204.github.io/myblog/">
        <img class="octicon" height="32" width="32" src="https://hly1204.github.io/myblog/images/github-mark-white.png">
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <img height="24" class="octicon octicon-three-bars" width="24" src="https://hly1204.github.io/myblog/images/github-mark-white.png">
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          <form target="_blank" action="https://www.google.com/search" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
              <input type="hidden" name="q" value="site:https://hly1204.github.io/myblog/">
            </label>
          </form>
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="https://hly1204.github.io/myblog/">
        <img class="octicon octicon-mark-github v-align-middle" height="32" width="32" src="https://hly1204.github.io/myblog/images/github-mark-white.png">
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>

  
<div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://hly1204.github.io/myblog/">
                  <img class=" avatar-user"
                    src="https://hly1204.github.io/myblog/images/icon.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://hly1204.github.io/myblog/">hly1204</a>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="https://hly1204.github.io/myblog/post/czt/">Chirp Z 变换</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Wed, 12 Jun 2024 22:39:13 &#43;0800"
                    class="no-wrap">
                    Wed, 12 Jun 2024 22:39:13 &#43;0800</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Sun, 21 Jul 2024 05:13:39 &#43;0000"
                    class="no-wrap">
                    Sun, 21 Jul 2024 05:13:39 &#43;0000</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      1626 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><h1 id="chirp-z-变换-czt">Chirp Z 变换 (CZT)</h1>
<p>这个东西很多人都很熟悉了，我们换一个不需要翻转多项式的方法。</p>
<p><strong>问题</strong>：给出 $f(x)=\sum_{i=0}^{m-1}f_ix^i\in\mathbb{C}\left\lbrack x\right\rbrack$ 和 $q\in\mathbb{C}$，求出 $f(1),f(q),\dots ,f(q^{n-1})$。</p>
<p>当 $q=0$ 时显然，我们考虑 $q\neq 0$ 时。考虑</p>
<p>$$
ij=\binom{i}{2}+\binom{-j}{2}-\binom{i-j}{2}
$$</p>
<p>其中 $\dbinom{a}{2}=\dfrac{a(a-1)}{2}$。那么我们构造</p>
<p>$$
\begin{aligned}
G(x)&amp;:=\sum_{i=-(m-1)}^{n-1}q^{-\binom{i}{2}}x^i, \\
F(x)&amp;:=\sum_{i=0}^{m-1}f_iq^{\binom{-i}{2}}x^i
\end{aligned}
$$</p>
<p>那么对于 $i=0,\dots ,n-1$ 有</p>
<p>$$
\begin{aligned}
\left\lbrack x^i\right\rbrack\left(G(x)F(x)\right)&amp;=\sum_{j=0}^{m-1}\left(\left\lbrack x^{i-j}\right\rbrack G(x)\right)\left(\left\lbrack x^j\right\rbrack F(x)\right) \\
&amp;=\sum_{j=0}^{m-1}f_jq^{\binom{-j}{2}-\binom{i-j}{2}} \\
&amp;=q^{-\binom{i}{2}}\cdot f\left(q^i\right)
\end{aligned}
$$</p>
<p>一次卷积，利用循环卷积优化。时间为 $O\left(\mathsf{M}\left(n+m\right)\right)$。</p>
<p><strong>备注</strong>：$q^{\binom{i+1}{2}}=q^{\binom{i}{2}}\cdot q^i$，$\dbinom{-i}{2}=\dbinom{i+1}{2}$。</p>
<h1 id="逆-chirp-z-变换-iczt">逆 Chirp Z 变换 (ICZT)</h1>
<p><strong>问题</strong>：给出 $f(1),f(q),\dots ,f(q^{n-1})$ 和 $q\in\mathbb{C}\setminus\left\lbrace 0\right\rbrace$ 且 $q^i\neq q^j,\forall i\neq j$ 求出 $f(x)=\sum_{i=0}^{n-1}f_ix^i\in\mathbb{C}\left\lbrack x\right\rbrack_{\lt n}$ 的系数。</p>
<p>回顾 Lagrange 插值公式：对于 $x_0,\dots ,x_{n-1}\in\mathbb{C}$ 有 $x_i\neq x_j,\forall i\neq j$，此时</p>
<p>$$
f(x)=\sum_{i=0}^{n-1}f\left(x_i\right)\prod_{0\leq j\lt n\atop j\neq i} \frac{x-x_j}{x_i-x_j}
$$</p>
<blockquote>
<p>L&rsquo;Hôpital 法则：
对于多项式的导数我们定义为 $f&rsquo;=\sum_{i}if_ix^{i-1}$，对于 $g\in\mathbb{C}\left\lbrack x\right\rbrack$ 有乘法法则：$\left(fg\right)&rsquo;=f&rsquo;g+fg&rsquo;$。若对于 $\alpha\in\mathbb{C}$ 有 $f(\alpha)=0$ 那么 $\left(fg\right)&rsquo;(\alpha)=f&rsquo;(\alpha)g(\alpha)$，所以若 $f&rsquo;(\alpha)\neq 0$ 那么 $(fg/f)(\alpha)=g(\alpha)=(fg)&rsquo;(\alpha)/f&rsquo;(\alpha)$。</p>
</blockquote>
<p>令</p>
<p>$$
M(x):=\prod_{i=0}^{n-1}\left(x-x_i\right)
$$</p>
<p>在这里 $M(x_i)=0\neq M&rsquo;(x_i)$ 因为对任意 $i=0,\dots ,n-1$ 都可以写成 $M(x)=(x-x_i)\prod_{0\leq j\lt n\atop j\neq i}(x-x_j)$，所以</p>
<p>$$
M&rsquo;(x_i)=\prod_{0\leq j\lt n\atop j\neq i}\left(x_i-x_j\right)
$$</p>
<p>此时 Lagrange 插值公式被改为</p>
<p>$$
f(x)=M(x)\cdot \sum_{i=0}^{n-1}\frac{f\left(x_i\right)}{M&rsquo;(x_i)}\frac{1}{x-x_i}
$$</p>
<p>再代入我们的和 $q$ 相关的情况就是</p>
<p>$$
f(x)=M(x)\cdot\sum_{i=0}^{n-1}\frac{f\left(q^i\right)}{M&rsquo;(q^i)}\frac{1}{x-q^i}
$$</p>
<p>在这里 $M(x)=\prod_{j=0}^{n-1}\left(x-q^j\right)$，不妨设 $n-1=2k$ 和</p>
<p>$$
H(x):=\prod_{j=0}^{k-1}\left(x-q^j\right)
$$</p>
<p>那么</p>
<p>$$
M(x)=H(x)\cdot q^{k^2}\cdot H\left(x/q^k\right)
$$</p>
<p>因为 $T(n)=T(n/2)+O\left(\mathsf{M}(n)\right)+O(n)\implies T(n)=O(\mathsf{M}(n))$ 可以在 $O\left(\mathsf{M}\left(n\right)\right)$ 求出 $M(x)$，然后利用 CZT 求出 $M&rsquo;(1),\dots ,M&rsquo;(q^{n-1})$，设 $c_i=f\left(q^i\right)/M&rsquo;\left(q^i\right)$ 那么</p>
<p>$$
f(x)=M(x)\cdot\sum_{i=0}^{n-1}\frac{c_i}{x-q^i}
$$</p>
<p>我们知道 $f(x)\in\mathbb{C}\left\lbrack x\right\rbrack_{\lt n}$ 所以只需计算出 $\sum_{i=0}^{n-1}\frac{c_i}{x-q^i}\bmod{x^n}$ 即可：</p>
<p>$$
\begin{aligned}
\sum_{i=0}^{n-1}\frac{c_i}{x-q^i}\bmod x^n&amp;=-\sum_{i=0}^{n-1}\left(\sum_{j=0}^{n-1}c_iq^{-i(j+1)}x^j\right) \\
&amp;=-\sum_{j=0}^{n-1}C\left(q^{-j-1}\right)x^j
\end{aligned}
$$</p>
<p>其中</p>
<p>$$
C(x)=\sum_{i=0}^{n-1}c_ix^i
$$</p>
<p>可以用 CZT 求出 $C\left(q^{-1}\right),\dots ,C\left(q^{-n}\right)$。</p>
<p>noshi91 指出，$M(x)$ 和 $M&rsquo;(1),\dots ,M&rsquo;\left(q^{n-1}\right)$ 可以用更快的方法计算。</p>
<p>我们重新考虑 $\prod_{0\leq j\lt n\atop j\neq i}\left(q^i-q^j\right)$，遵循 noshi91 的定义，令 $s_i:=\prod_{j=1}^i\left(1-q^j\right)$ 且 $s_0:=1$，那么</p>
<p>$$
\begin{aligned}
\prod_{0\leq j\lt n\atop j\neq i}\left(q^i-q^j\right)&amp;=\left(\prod_{j=0}^{i-1}\left(q^i-q^j\right)\right)\left(\prod_{j=i+1}^{n-1}\left(q^i-q^j\right)\right) \\
&amp;=\left(\prod_{j=0}^{i-1}q^j\left(q^{i-j}-1\right)\right)\left(\prod_{j=i+1}^{n-1}q^i\left(1-q^{j-i}\right)\right) \\
&amp;=(-1)^iq^{\sum_{j=0}^{i-1}j}\left(\prod_{j=0}^{i-1}\left(1-q^{i-j}\right)\right)\cdot q^{i(n-i-1)}\left(\prod_{j=i+1}^{n-1}\left(1-q^{j-i}\right)\right) \\
&amp;=(-1)^iq^{\binom{i}{2}}\left(\prod_{k=1}^{i}\left(1-q^k\right)\right)\cdot q^{i(n-i-1)}\left(\prod_{k=1}^{n-i-1}\left(1-q^k\right)\right) \\
&amp;=(-1)^iq^{\binom{i}{2}}s_i\cdot q^{i(n-i-1)}s_{n-i-1}
\end{aligned}
$$</p>
<p>注意到 $q^{\binom{i+1}{2}}\cdot q^{(i+1)(n-(i+1)-1)}=\left(q^{\binom{i}{2}}\cdot q^{i}\right)\left(q^{i(n-i-1)}\cdot q^{n-2i-2}\right)$ 可递推计算。</p>
<h2 id="q-模拟-q-analog">$q$-模拟 ($q$-analog)</h2>
<p>我们定义 $n\in\mathbb{N}$ 的 $q$-模拟为</p>
<p>$$
\left\lbrack n\right\rbrack_q:=\begin{cases}
0,&amp;\text{if }n=0, \\
1+q+\cdots +q^{n-1},&amp;\text{otherwise}.
\end{cases}
$$</p>
<p>注意到 $q=1$ 时，有 $\left\lbrack n\right\rbrack_q=n$。并且 $q\left\lbrack n\right\rbrack_q =q+q^2+\cdots +q^n$ 所以</p>
<p>$$
\left\lbrack n\right\rbrack_q=\begin{cases}
n,&amp;\text{if }q=1, \\
\dfrac{1-q^n}{1-q},&amp;\text{otherwise}.
\end{cases}
$$</p>
<p>我们也可以发现</p>
<p>$$
\begin{aligned}
\left\lbrack -n\right\rbrack_q&amp;=\frac{1-q^{-n}}{1-q} \\
&amp;=q^{-n}\frac{q^n-1}{1-q} \\
&amp;=-q^{-n}\left\lbrack n\right\rbrack_q
\end{aligned}
$$</p>
<p>然后我们可以定义 $q$-阶乘</p>
<p>$$
n!_q:=\begin{cases}
1,&amp;\text{if }n=0, \\
\left\lbrack 1\right\rbrack_q\left\lbrack 2\right\rbrack_q\cdots \left\lbrack n\right\rbrack_q,&amp;\text{otherwise}.
\end{cases}
$$</p>
<p>最后我们定义 $q$-二项式系数</p>
<p>$$
\binom{n}{k}_q:=\begin{cases}
\dfrac{n!_q}{k!_q(n-k)!_q},&amp;\text{if }0\leq k\leq n, \\
0,&amp;\text{otherwise}.
\end{cases}
$$</p>
<p>为了证明下面的定理，我们先引入一些常见的性质。</p>
<p>若 $q\neq 1$ 我们有</p>
<p>$$
\begin{aligned}
\left\lbrack n\right\rbrack_q&amp;=\frac{1-q^n}{1-q} \\
&amp;=\frac{1-q^k+q^k-q^n}{1-q} \\
&amp;=\frac{1-q^k}{1-q}+q^k\frac{1-q^{n-k}}{1-q} \\
&amp;=\left\lbrack k\right\rbrack_q +q^k\left\lbrack n-k\right\rbrack_q
\end{aligned}
$$</p>
<p>而当 $q=1$ 时我们有 $n=k+(n-k)$ 所以上式仍然成立。因此</p>
<p>$$
\begin{aligned}
\binom{n+1}{k}_q&amp;=\frac{(n+1)!_q}{k!_q(n+1-k)!_q} \\
&amp;=\frac{n!_q}{k!_q(n+1-k)!_q}\cdot \left(\left\lbrack k\right\rbrack_q +q^k\left\lbrack n+1-k\right\rbrack_q\right) \\
&amp;=\frac{n!_q}{(k-1)!_q(n+1-k)!_q}\cdot \left\lbrack k\right\rbrack_q^{-1}\cdot \left(\left\lbrack k\right\rbrack_q +q^k\left\lbrack n+1-k\right\rbrack_q\right) \\
&amp;=\frac{n!_q}{(k-1)!_q(n+1-k)!_q}+q^k\frac{n!_q\left\lbrack n+1-k\right\rbrack_q}{k!_q(n+1-k)!_q} \\
&amp;=\binom{n}{k-1}_q+q^k\binom{n}{k}_q
\end{aligned}
$$</p>
<p>因为 $q$-二项式系数也有对称性</p>
<p>$$
\binom{n}{k}_q=\binom{n}{n-k}_q
$$</p>
<p>我们将上式 $k$ 用 $n+1-k$ 替换得到了</p>
<p>$$
\begin{aligned}
\binom{n+1}{k}_q&amp;=\binom{n+1}{n+1-k}_q \\
&amp;=\binom{n}{n-k}_q+q^{n+1-k}\binom{n}{n+1-k}_q \\
&amp;=\binom{n}{k}_q+q^{n-k+1}\binom{n}{k-1}_q
\end{aligned}
$$</p>
<p>这被称为 $q$-Pascal 递推式。</p>
<h3 id="rothe-的-q-二项式定理">Rothe 的 $q$-二项式定理</h3>
<p>对于变量 $q,a,x$ 有</p>
<p>$$
\prod_{i=0}^{n-1}\left(a+q^ix\right)=\sum_{k=0}^n\binom{n}{k}_qq^{\binom{k}{2}}a^{n-k}x^k
$$</p>
<p>特别的，当 $n=0$ 时左式定义为 $1$。</p>
<p><strong>证明</strong>：设 $r_n(x,a)$ 等于右式，应用上述 $q$-Pascal 递推式，我们有</p>
<p>$$
\begin{aligned}
r_{n+1}(x,a)&amp;=\sum _ {k=0}^{n+1}\binom{n+1}{k}_qq^{\binom{k}{2}}x^ka^{n+1-k} \\
&amp;=\sum _ {k=0}^{n+1}\left(\binom{n}{k-1}_q+q^k\binom{n}{k}_q\right)q^{\binom{k}{2}}x^ka^{n+1-k} \\
&amp;=\sum _ {k=1}^{n+1}\binom{n}{k-1}_qq^{\binom{k}{2}}x^ka^{n+1-k}+\sum _ {k=0}^{n}\binom{n}{k}_qq^{\binom{k}{2}}\left(qx\right)^ka^{n+1-k} \\
&amp;=\sum _ {j=0}^{n}\binom{n}{j}_qq^{\binom{j+1}{2}}x^{j+1}a^{n-j}+\sum _ {j=0}^{n}\binom{n}{j}_qq^{\binom{j}{2}}\left(qx\right)^ja^{n+1-j}
\end{aligned}
$$</p>
<p>第三行中我们使用 $\dbinom{n}{-1}_q=\dbinom{n}{n+1}_q=0$，前面我们提到对于 $j\in\mathbb{N}$ 有 $\dbinom{j+1}{2}=\dbinom{j}{2}+j$，那么</p>
<p>$$
\begin{aligned}
r_{n+1}(x,a)&amp;=\sum _ {j=0}^{n}\binom{n}{j}_qq^{\binom{j}{2}}q^jx^{j+1}a^{n-j}+\sum _ {j=0}^{n}\binom{n}{j}_qq^{\binom{j}{2}}\left(qx\right)^ja^{n+1-j} \\
&amp;=\sum _ {j=0}^{n}\binom{n}{j}_qq^{\binom{j}{2}}\left(qx\right)^ja^{n-j}x+\sum _ {j=0}^{n}\binom{n}{j}_qq^{\binom{j}{2}}\left(qx\right)^ja^{n+1-j} \\
&amp;=\sum _ {j=0}^{n}\binom{n}{j}_qq^{\binom{j}{2}}\left(qx\right)^ja^{n-j}(x+a) \\
&amp;=(a+x)r_n(qx,a)
\end{aligned}
$$</p>
<p>重复下去我们有</p>
<p>$$
\begin{aligned}
r_{n+1}(x,a)&amp;=(a+x)r_n(qx,a) \\
&amp;=(a+x)(a+qx)r_{n-1}\left(q^2x,a\right) \\
&amp;=\cdots \\
&amp;=(a+x)(a+qx)\cdots \left(a+q^nx\right)r_0\left(q^{n+1}x,a\right)
\end{aligned}
$$</p>
<p>而我们已经定义了 $r_0(u,v)=1$。</p>
<p>回到我们的问题，那么</p>
<p>$$
\begin{aligned}
M(x)&amp;=\prod_{j=0}^{n-1}\left(x-q^j\right) \\
&amp;=\sum_{k=0}^n\binom{n}{k}_qq^{\binom{k}{2}}(-1)^kx^{n-k}
\end{aligned}
$$</p>
<p>而 $\dbinom{n}{k}_q=\dfrac{\left(1-q\right)\cdots \left(1-q^n\right)}{\left(1-q\right)\cdots \left(1-q^k\right)\cdot \left(1-q\right)\cdots \left(1-q^{n-k}\right)}=\dfrac{s_n}{s_ks _ {n-k}}$。</p>
<p><strong>备注</strong>：若 $q^n=1$ 不能再使用上式，我们按照定义计算。</p>
<h1 id="参考文献">参考文献</h1>
<ol>
<li>37zigen. <a href="https://37zigen.com/lagrange-interpolation/">多項式補間：アルゴリズム</a>.</li>
<li>noshi91. <a href="https://noshi91.github.io/algorithm-encyclopedia/polynomial-interpolation-geometric">標本点が等比数列を成す場合に補間多項式を計算するアルゴリズム</a>.</li>
<li>Bostan, A. (2010). <a href="https://specfun.inria.fr/bostan/publications/exposeJNCF.pdf">Fast algorithms for polynomials and matrices. JNCF 2010. Algorithms Project, INRIA</a>.</li>
<li>Warren P. Johnson. An Introduction to $q$-analysis.</li>
</ol>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://hly1204.github.io/myblog/js/toc.js'></script>
<link rel="stylesheet" href='https://hly1204.github.io/myblog/css/toc.css' />



  <div class="footer container-xl width-full p-responsive">
  <div
    class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between flex-sm-items-center pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mr-lg-4" href="https://hly1204.github.io/myblog/">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24">
        <path fill-rule="evenodd"
          d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
        </path>
      </svg>
    </a>
    <ul class="list-style-none d-flex flex-wrap col-12 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      
      <li class="mr-3 mr-lg-0">Theme by <a href='https://github.com/MeiK2333/github-style'>github-style</a></li>
      
    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>


</div>
</body>

<script type="application/javascript" src="https://hly1204.github.io/myblog/js/github-style.js"></script>



<script type="text/javascript" async
  src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
        processEscapes: true,
        processEnvironments: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
        TeX: {
          equationNumbers: { autoNumber: "AMS" },
          extensions: ["AMSmath.js", "AMSsymbols.js"]
        }
      }
    });

    MathJax.Hub.Queue(function () {
      
      
      
      var all = MathJax.Hub.getAllJax(), i;
      for (i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

<style>
  code.has-jax {
    font: inherit;
    font-size: 100%;
    background: inherit;
    border: inherit;
    color: #515151;
  }
</style>


</html>